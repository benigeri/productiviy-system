{"id":"productiviy-system-05h","title":"nylas-webhook: deploy \u0026 register with Nylas","description":"Deploy and register webhook:\n1. Deploy edge function to Supabase\n2. Register webhook with Nylas: POST /webhooks/\n   - trigger_types: [message.updated, message.created]\n   - webhook_url: Supabase function URL\n3. Test with real Gmail label changes\n4. Add NYLAS_WEBHOOK_SECRET to Supabase secrets","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T11:27:59.938964-05:00","created_by":"benigeri","updated_at":"2026-01-07T15:54:27.730319-05:00","closed_at":"2026-01-07T15:54:27.730319-05:00","close_reason":"Deployed nylas-webhook edge function, registered with Nylas, and fixed folder ID bug. Verified with real Gmail test.","dependencies":[{"issue_id":"productiviy-system-05h","depends_on_id":"productiviy-system-alf","type":"blocks","created_at":"2026-01-07T11:28:29.866354-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-0so","title":"Create /compose-email skill for net-new emails","description":"Add compose feature to email workflow web app (https://email-workflow-phi.vercel.app). Allow users to create new emails from scratch, not just reply to existing threads. Implementation: Add /compose route with form for To/CC/Subject/Body, use existing Braintrust draft generation API, reuse Nylas draft creation logic from /api/drafts route.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-09T19:29:17.585805-05:00","created_by":"benigeri","updated_at":"2026-01-10T13:33:13.134265-05:00"}
{"id":"productiviy-system-0sq","title":"Create core capture pipeline (_shared/lib/capture.ts)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T08:21:15.497705-05:00","created_by":"benigeri","updated_at":"2026-01-06T08:39:05.548873-05:00","closed_at":"2026-01-06T08:39:05.548873-05:00","close_reason":"Implemented captureToLinear() with tests - 6 passing tests"}
{"id":"productiviy-system-11s","title":"Debug Nylas webhook not triggering on label changes","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-08T15:59:18.382734-05:00","created_by":"benigeri","updated_at":"2026-01-08T17:31:42.355105-05:00","closed_at":"2026-01-08T17:31:42.355105-05:00","close_reason":"Webhook is working as designed. Triggers on message.created/updated for cleanup/deduplication. Does not ADD labels - only removes them (archive, send, dedup scenarios). Verified: function ACTIVE, Nylas webhook ACTIVE."}
{"id":"productiviy-system-126","title":"Email workflow: Draft mismatch between panel and Gmail","description":"## Problem\nAI is called twice during draft workflow - once for display, once on approve.\nThis produces different drafts due to AI non-determinism.\n\n## Solution\nSingle generation + temp file storage. See docs/email-workflow-improvements.md Issue #1.\n\n## Implementation\n- Update SKILL.md workflow to use temp file pattern\n- Generate once → /tmp/email-draft-{THREAD_ID}.json\n- Display from file, send from file, cleanup after\n\n## Dependencies\n- Depends on: productiviy-system-mhg (dictation arg needed first)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-07T22:27:19.449081-05:00","created_by":"benigeri","updated_at":"2026-01-08T08:32:10.649716-05:00","closed_at":"2026-01-08T08:32:10.649716-05:00","close_reason":"Temp file pattern implemented in SKILL.md (PR #38). Draft stored to /tmp/email-draft-{THREAD_ID}.json ensures same draft shown in panel goes to Gmail.","dependencies":[{"issue_id":"productiviy-system-126","depends_on_id":"productiviy-system-mhg","type":"blocks","created_at":"2026-01-08T08:15:46.606597-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-16p","title":"Linear task → drafted email workflow","description":"Build integration to go from a Linear task directly to a drafted email response.\n\nRequires:\n- Shared services between email workflow and Linear\n- Task context extraction (assignee, description, linked threads)\n- Email drafting with task context\n- Possibly bidirectional: email replies that update Linear tasks\n\nBig feature - needs architecture planning first.","status":"open","priority":4,"issue_type":"feature","created_at":"2026-01-08T20:22:02.189959-05:00","created_by":"benigeri","updated_at":"2026-01-08T20:22:02.189959-05:00"}
{"id":"productiviy-system-16s","title":"Initialize Supabase in repo","description":"Run supabase init and supabase functions new telegram-webhook to scaffold the project","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T11:00:21.716008-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:01:13.214477-05:00","closed_at":"2026-01-05T13:01:13.214477-05:00","close_reason":"Supabase initialized, PR #6 created"}
{"id":"productiviy-system-1e8","title":"Refactor create-issue to use DI + captureToLinear()","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T08:21:19.073001-05:00","created_by":"benigeri","updated_at":"2026-01-06T09:18:38.504239-05:00","closed_at":"2026-01-06T09:18:38.504239-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-1e8","depends_on_id":"productiviy-system-0sq","type":"blocks","created_at":"2026-01-06T08:21:26.746437-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-1ex","title":"/handle-to-respond-paul-emails skill","description":"Create /handle-to-respond-paul-emails skill:\n1. Fetch emails with to-respond-paul label\n2. Show count, display first email (full context)\n3. Get user dictation → generate draft with Claude\n4. Create draft via Nylas (with reply_to_message_id)\n5. Update labels: remove to-respond-paul, add drafted\n6. Commands: next (show next), skip (keep label, next), done (exit)\n7. Placeholder email-writing-guidelines.md for later","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T11:28:01.168082-05:00","created_by":"benigeri","updated_at":"2026-01-07T16:12:51.55275-05:00","closed_at":"2026-01-07T16:12:51.55275-05:00","close_reason":"Created skill and command. PR #32. Verified API works - fetched 10 emails.","dependencies":[{"issue_id":"productiviy-system-1ex","depends_on_id":"productiviy-system-05h","type":"blocks","created_at":"2026-01-07T11:28:32.531115-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-1tx","title":"Create message_mappings table in Supabase","description":"Milestone 2: Create Supabase table for telegram_msg_id → linear_issue_id mapping","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T11:00:51.817968-05:00","created_by":"benigeri","updated_at":"2026-01-05T11:00:51.817968-05:00"}
{"id":"productiviy-system-28m","title":"Show draft in tmux panel only, not in Claude conversation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:59:30.222651-05:00","created_by":"benigeri","updated_at":"2026-01-08T17:38:22.808444-05:00","closed_at":"2026-01-08T17:38:22.808444-05:00","close_reason":"Implemented in feature/ux-improvements branch"}
{"id":"productiviy-system-2aq","title":"Set up testing infrastructure for email-workflow","description":"## Problem\nEmail-workflow project has zero testing infrastructure. Cannot write tests without Jest/Vitest setup. CLAUDE.md requires TDD but we have no way to run tests.\n\n## What's Needed\n\n### Phase 1: Testing Infrastructure Setup (1-2 hours)\n1. Install dependencies:\n   ```bash\n   npm install --save-dev jest @jest/globals @testing-library/react @testing-library/react-hooks @testing-library/jest-dom jest-environment-jsdom\n   ```\n\n2. Create jest.config.js for Next.js:\n   ```js\n   const nextJest = require('next/jest')\n   const createJestConfig = nextJest({ dir: './' })\n   const customJestConfig = {\n     setupFilesAfterEnv: ['\u003crootDir\u003e/jest.setup.js'],\n     testEnvironment: 'jest-environment-jsdom',\n     moduleNameMapper: { '^@/(.*)$': '\u003crootDir\u003e/$1' },\n   }\n   module.exports = createJestConfig(customJestConfig)\n   ```\n\n3. Add test script to package.json:\n   ```json\n   \"test\": \"jest\",\n   \"test:watch\": \"jest --watch\",\n   \"test:coverage\": \"jest --coverage\"\n   ```\n\n4. Create jest.setup.js with globals\n\n### Phase 2: Write Tests (4-6 hours)\n- Create lib/conversation.test.ts (comprehensive)\n- Create hooks/useConversation.test.tsx\n- Mock localStorage properly\n- Test all edge cases (corrupted data, quota, SSR, race conditions)\n- Achieve \u003e80% coverage\n\n## Acceptance Criteria\n- [ ] Jest + React Testing Library installed and configured\n- [ ] npm test runs successfully\n- [ ] conversation.test.ts created with comprehensive tests\n- [ ] useConversation.test.tsx created\n- [ ] All tests pass\n- [ ] Coverage report shows \u003e80%\n- [ ] CI pipeline configured to run tests\n\n## Resources\n- Todo file: todos/004-pending-p1-add-test-coverage-conversation-management.md\n- PR #60: https://github.com/benigeri/productiviy-system/pull/60\n- Next.js testing docs: https://nextjs.org/docs/testing\n\n## Effort\n6-8 hours total (setup + tests)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T18:56:35.206288-05:00","created_by":"benigeri","updated_at":"2026-01-10T18:56:35.206288-05:00"}
{"id":"productiviy-system-2dy","title":"Fix XSS vulnerability in ThreadDetail conversation rendering","description":"## Problem\nOWASP A03 injection vulnerability. Unescaped content in ThreadDetail.tsx allows arbitrary JavaScript execution. Can steal session data, exfiltrate conversations.\n\n## Solution\nUse React text escaping (stripHtml function) + add CSP headers. Content is plain text, not HTML.\n\n## Acceptance Criteria\n- All user-generated content sanitized before rendering\n- All assistant-generated content sanitized\n- XSS test vectors do not execute\n- CSP headers block inline scripts\n\n## Resources\n- Todo file: todos/003-pending-p1-fix-xss-vulnerability-unescaped-content.md\n- PR #60: https://github.com/benigeri/productiviy-system/pull/60\n- File: email-workflow/app/inbox/ThreadDetail.tsx (lines 129, 152-154, 193)\n\n## Effort\n15 min - 1 hour","status":"open","priority":0,"issue_type":"bug","created_at":"2026-01-10T18:51:45.089845-05:00","created_by":"benigeri","updated_at":"2026-01-10T18:51:45.089845-05:00"}
{"id":"productiviy-system-2e5","title":"Test skill end-to-end workflow","description":"Run through complete skill workflow to verify functionality.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.568479-05:00","updated_at":"2026-01-06T18:44:06.372926-05:00","closed_at":"2026-01-06T18:44:06.372926-05:00","close_reason":"E2E test passed: created/deleted test Sleep event via API","dependencies":[{"issue_id":"productiviy-system-2e5","depends_on_id":"productiviy-system-5r9","type":"parent-child","created_at":"2026-01-06T08:42:03.060497-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2e5","depends_on_id":"productiviy-system-v31","type":"blocks","created_at":"2026-01-06T08:42:08.477153-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2e5","depends_on_id":"productiviy-system-zgh","type":"blocks","created_at":"2026-01-06T08:42:08.513795-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-2fb","title":"E2E test and cleanup: re-run workflow, verify fixes, archive docs","description":"Final verification: 1) Re-run email workflow end-to-end with user driving, 2) Verify all bug fixes work, 3) Archive/cleanup E2E-BUGS.md and IMPROVEMENT-PLAN.md once verified. This is the final task before closing the epic.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T10:22:53.986015-05:00","created_by":"benigeri","updated_at":"2026-01-09T23:07:38.041945-05:00","closed_at":"2026-01-09T23:07:38.041945-05:00","close_reason":"E2E testing complete. All bugs fixed: hotkeys work, display clean, formatting good. PR #57 created.","dependencies":[{"issue_id":"productiviy-system-2fb","depends_on_id":"productiviy-system-i3u","type":"blocks","created_at":"2026-01-08T10:23:07.558192-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2fb","depends_on_id":"productiviy-system-g3c","type":"blocks","created_at":"2026-01-08T10:23:07.626301-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2fb","depends_on_id":"productiviy-system-a5j","type":"blocks","created_at":"2026-01-08T10:23:07.68392-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-2m4","title":"Email Workflow: Iteration UI Improvements","description":"Add draft iteration, Skip/Approve buttons, and shadcn UI to email workflow web app.\n\n**Current Issues:**\n- Drafts auto-save to Gmail immediately (should only save on Approve)\n- No feedback/iteration loop for refining drafts\n- No Skip/Approve buttons\n- Plain HTML forms (need shadcn for better UX)\n\n**New Flow:**\n1. View thread → Enter instructions → Generate draft\n2. Draft preview appears with feedback textbox\n3. User can iterate: give feedback → regenerate → review\n4. Click Skip: go to next email (no draft saved)\n5. Click Approve: save to Gmail, update labels, auto-advance\n\n**Technical:**\n- Conversation state in localStorage per thread\n- shadcn components (Button, Card, Textarea, Input)\n- Refactor API: /api/drafts POST (generate only), PUT (approve \u0026 save)\n- No auto-save until Approve clicked\n\n**Dependencies:** All sub-beads for implementation phases","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-10T16:30:19.40216-05:00","created_by":"benigeri","updated_at":"2026-01-10T16:30:19.40216-05:00","dependencies":[{"issue_id":"productiviy-system-2m4","depends_on_id":"productiviy-system-rbm","type":"blocks","created_at":"2026-01-10T16:36:04.622282-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2m4","depends_on_id":"productiviy-system-8a4","type":"blocks","created_at":"2026-01-10T16:36:04.668651-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2m4","depends_on_id":"productiviy-system-xhs","type":"blocks","created_at":"2026-01-10T16:36:04.710144-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2m4","depends_on_id":"productiviy-system-n0i","type":"blocks","created_at":"2026-01-10T16:36:04.747721-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-2m4","depends_on_id":"productiviy-system-ohj","type":"blocks","created_at":"2026-01-10T16:36:04.784756-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-3ee","title":"Add localStorage quota management and cleanup","description":"Implement automatic cleanup of old conversation data and quota management to prevent localStorage from filling up.\n\n**Context**: PR #61 review found that conversation.ts has no size limits, TTL, or cleanup. After ~100 threads, localStorage hits 5-10MB quota and silently fails.\n\n**Problem**:\n- Conversations stored indefinitely\n- No maximum size enforcement\n- No cleanup of old data\n- Silent failure when quota exceeded\n- User loses data without warning\n\n**Scope**:\n- Add TTL to conversations (delete after 30 days)\n- Implement cleanupExpiredConversations() utility\n- Add quota check before saving (warn at 4MB)\n- Handle QuotaExceededError gracefully\n- Show warning to user when approaching quota\n- Write tests for cleanup logic\n\n**Implementation**:\n- Add timestamp-based expiration\n- Run cleanup on each setStore() call\n- Add size calculation before save\n- Retry save after cleanup if quota exceeded\n\n**Acceptance Criteria**:\n- [ ] Conversations auto-delete after 30 days\n- [ ] Quota checked before each save\n- [ ] Warning shown when \u003e4MB used\n- [ ] QuotaExceededError triggers cleanup + retry\n- [ ] Tests verify cleanup and quota handling\n\n**Resources**:\n- Data integrity review findings\n- File: email-workflow/lib/conversation.ts","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:43.778618-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:43.778618-05:00"}
{"id":"productiviy-system-3jh","title":"Email Workflow: Build label update API","description":"Create app/api/threads/route.ts for label updates.\n\nIncludes:\n- Zod validation\n- Fetch thread to get message IDs\n- Update labels on all messages\n- Error handling\n\nFile: app/api/threads/route.ts (~30 lines)\nEstimated: 2 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T12:32:14.595176-05:00","created_by":"benigeri","updated_at":"2026-01-10T12:45:02.514019-05:00","closed_at":"2026-01-10T12:45:02.514019-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-3jh","depends_on_id":"productiviy-system-b0o","type":"blocks","created_at":"2026-01-10T12:32:29.260311-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-3xb","title":"Organize productivity system into clear domains","description":"The productivity system has multiple capabilities (email workflow, calendar management, etc.) but they're not clearly separated. Consider organizing into clear domains with their own documentation: 1) Email triage workflow, 2) Calendar management, 3) Issue/task capture. Each domain should have clear entry points and documentation.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-09T08:32:20.383114-05:00","created_by":"benigeri","updated_at":"2026-01-09T08:32:20.383114-05:00"}
{"id":"productiviy-system-4dd","title":"Write tests for linear.ts, then implement","description":"TDD: Write tests for createTriageIssue function using BEN team, then implement","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:29.745861-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:24:30.538122-05:00","closed_at":"2026-01-05T13:24:30.538122-05:00","close_reason":"All tests pass for linear.ts"}
{"id":"productiviy-system-4fi","title":"Email Workflow: Build inbox page","description":"Build app/inbox/page.tsx with Server Components.\n\nIncludes:\n- Server Component to fetch threads from Nylas\n- ThreadList client component for UI\n- ThreadDetail client component for messages + draft\n- Direct localStorage for session counts\n\nFile: app/inbox/page.tsx (~100 lines)\nEstimated: 1 day","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T12:31:58.206232-05:00","created_by":"benigeri","updated_at":"2026-01-10T12:42:54.305922-05:00","closed_at":"2026-01-10T12:42:54.305922-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-4fi","depends_on_id":"productiviy-system-dxe","type":"blocks","created_at":"2026-01-10T12:32:29.17185-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-52r","title":"Add content sanitization to prevent XSS in email workflow","description":"Install DOMPurify and sanitize all user-generated and LLM-generated content before displaying in the UI to prevent XSS attacks.\n\n**Context**: PR #61 review found that draft content from Braintrust LLM and localStorage is displayed without sanitization. While React escapes by default, this is fragile if code is refactored.\n\n**Vulnerable Locations**:\n- ThreadDetail.tsx:304 - Draft preview content\n- ThreadDetail.tsx:128 - Email message bodies\n- ThreadDetail.tsx:152 - Conversation history messages\n\n**Scope**:\n- Install DOMPurify and @types/dompurify\n- Create lib/sanitize.ts with sanitizeText() and sanitizeHTML() utilities\n- Apply sanitization at all render points for user/LLM content\n- Add Content Security Policy headers in next.config.ts\n- Write tests for sanitization\n\n**Acceptance Criteria**:\n- [ ] DOMPurify installed and configured\n- [ ] All draft content sanitized before display\n- [ ] All message bodies sanitized\n- [ ] Conversation history sanitized\n- [ ] CSP headers configured\n- [ ] Tests verify HTML/script tags are stripped\n\n**Resources**:\n- Security review: todos/009 mentions this\n- DOMPurify docs: https://github.com/cure53/DOMPurify","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:43.148917-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:43.148917-05:00"}
{"id":"productiviy-system-5g6","title":"Email panel: reverse message order and add visual separation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T20:56:16.87053-05:00","created_by":"benigeri","updated_at":"2026-01-09T08:48:58.498136-05:00","closed_at":"2026-01-09T08:48:58.498136-05:00","close_reason":"Fixed in commit 0367a7a on fix/email-workflow-bugs branch"}
{"id":"productiviy-system-5ls","title":"Update Edge Function to handle replies → Linear comments","description":"Milestone 2: Implement reply handling - lookup parent message, add comment to existing Linear issue","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T11:00:52.224074-05:00","created_by":"benigeri","updated_at":"2026-01-05T11:00:52.224074-05:00"}
{"id":"productiviy-system-5r9","title":"[epic] Build weekly-cadence Claude Code skill","description":"Create a Claude Code skill to manage sleep blocks and workout events via Nylas Calendar API.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.565375-05:00","updated_at":"2026-01-06T18:44:06.580177-05:00","closed_at":"2026-01-06T18:44:06.580177-05:00","close_reason":"Epic complete: skill at ~/.claude/skills/weekly-cadence/ with SKILL.md and API reference"}
{"id":"productiviy-system-5zq","title":"Merge PR #50: Fix duplicate command/skill names","description":"PR #50 fixes the duplicate handle-to-respond-paul registration (both command file and skill SKILL.md register it). This PR also adds a test to prevent future duplicates. Needs to be merged.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T08:32:12.880466-05:00","created_by":"benigeri","updated_at":"2026-01-09T08:48:58.486823-05:00","closed_at":"2026-01-09T08:48:58.486823-05:00","close_reason":"Fixed in commit 0367a7a on fix/email-workflow-bugs branch"}
{"id":"productiviy-system-7cf","title":"Write tests for reply handling","description":"Milestone 2: TDD for reply detection, message lookup, and comment creation","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T11:00:52.024983-05:00","created_by":"benigeri","updated_at":"2026-01-05T11:00:52.024983-05:00"}
{"id":"productiviy-system-7d5","title":"nylas-webhook: API client + tests","description":"TDD: Create Nylas API client in lib/nylas.ts:\n- getMessage(id): GET /grants/{id}/messages/{msg_id}\n- getThread(id): GET /grants/{id}/threads/{thread_id}\n- updateMessageFolders(id, folders): PUT /grants/{id}/messages/{msg_id}\n- getFolders(): GET /grants/{id}/folders (for label ID mapping)\n- verifyNylasSignature(signature, body, secret): HMAC-SHA256\n- Lazy load: fetch message only when needed","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T11:27:55.728636-05:00","created_by":"benigeri","updated_at":"2026-01-07T15:11:00.070048-05:00","closed_at":"2026-01-07T15:11:00.070048-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-7d5","depends_on_id":"productiviy-system-peq","type":"blocks","created_at":"2026-01-07T11:28:25.347551-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-7g1","title":"Debug clickable links in Ghostty/Agent Deck terminal","description":"URLs in session summary not clickable in Ghostty terminal with Agent Deck. Investigate: 1) OSC 8 escape sequence support in Ghostty, 2) Agent Deck terminal passthrough, 3) Alternative approaches (e.g., copy to clipboard, open command). May need show-summary.py helper script.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-08T10:54:11.853134-05:00","created_by":"benigeri","updated_at":"2026-01-08T17:38:12.463545-05:00","closed_at":"2026-01-08T17:38:12.463545-05:00","close_reason":"Investigation complete: Ghostty supports OSC 8 but escape sequences get stripped by Claude Code output pipeline. Plain URLs work with cmd-click (default Ghostty behavior). No code changes needed - the simplified session summary URL is clickable via cmd-click."}
{"id":"productiviy-system-7l0","title":"Add tmux hotkeys for instant email actions (Alt+A/S/D/V)","description":"Add tmux hotkeys for instant email actions during workflow. Hotkeys: Alt+A (approve), Alt+S (skip), Alt+D (done), Alt+V (paste dictation from clipboard). Uses tmux set-buffer/paste-buffer for multi-line support. Bindings activate on panel create, deactivate on close. Files: email-hotkeys.sh (setup/teardown), panel-manager.sh (integration).","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T19:29:17.379192-05:00","created_by":"benigeri","updated_at":"2026-01-09T20:59:19.757963-05:00","closed_at":"2026-01-09T20:59:19.757963-05:00","close_reason":"Closed"}
{"id":"productiviy-system-80h","title":"Move hard-coded Gmail label IDs to environment variables","description":"Replace hard-coded Gmail label IDs with environment variables to support multiple Gmail accounts.\n\n**Context**: PR #61 review found hard-coded label IDs (Label_215, Label_139) in route.ts that are environment-specific.\n\n**Problem**:\n- Label IDs are unique per Gmail account\n- Code breaks if labels recreated\n- Can't use in different Gmail accounts\n- No documentation of what labels mean\n\n**Current Code**:\n```typescript\naddLabels: ['Label_215'], // drafted label\nremoveLabels: ['Label_139'], // to-respond-paul label\n```\n\n**Scope**:\n- Add to .env.local:\n  - GMAIL_LABEL_DRAFTED=Label_215\n  - GMAIL_LABEL_TO_RESPOND=Label_139\n- Update .env.example with label documentation\n- Create lib/constants.ts for label constants\n- Update all references in route.ts and docs\n- Add validation that labels exist\n\n**Acceptance Criteria**:\n- [ ] Label IDs in environment variables\n- [ ] .env.example documents label purpose\n- [ ] lib/constants.ts exports typed constants\n- [ ] All hard-coded IDs replaced\n- [ ] Error if required env vars missing\n\n**Resources**:\n- Files: email-workflow/app/api/drafts/route.ts:144-145\n- File: email-workflow/app/api/threads/route.ts","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:43.929969-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:43.929969-05:00"}
{"id":"productiviy-system-8a4","title":"Email Workflow: Add conversation state management","description":"Add localStorage-backed conversation state for draft iterations.\n\n**State structure:**\n```typescript\n{\n  [threadId]: {\n    messages: [\n      { role: 'user', content: 'Initial instructions' },\n      { role: 'assistant', content: '\u003cp\u003eDraft HTML\u003c/p\u003e' },\n      { role: 'user', content: 'Make it shorter' },\n      { role: 'assistant', content: '\u003cp\u003eShorter draft\u003c/p\u003e' }\n    ],\n    currentDraft: '\u003cp\u003eLatest draft HTML\u003c/p\u003e'\n  }\n}\n```\n\n**Implementation:**\n- Create useConversation hook\n- Load/save to localStorage\n- Clear conversation on Approve\n- Persist across page refreshes\n\n**Test:**\n- State persists on refresh\n- Cleared after approval\n- Multiple threads don't interfere","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T16:35:55.870878-05:00","created_by":"benigeri","updated_at":"2026-01-10T18:59:31.144263-05:00","closed_at":"2026-01-10T18:59:31.144263-05:00","close_reason":"PR #60 merged successfully. Conversation state management implemented with localStorage backend, Zod validation, and full UI integration. Created follow-up beads for XSS fix, quota handling, and testing infrastructure."}
{"id":"productiviy-system-8gw","title":"draft-email.py: CC field returns strings instead of objects","description":"When generating drafts, the CC field sometimes returns plain email strings instead of {email, name} objects. This causes Nylas API errors (400 bad request). Workaround: transform strings to objects before sending. Fix: ensure draft-email.py always returns proper format.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T08:32:11.037743-05:00","created_by":"benigeri","updated_at":"2026-01-09T08:48:58.4957-05:00","closed_at":"2026-01-09T08:48:58.4957-05:00","close_reason":"Fixed in commit 0367a7a on fix/email-workflow-bugs branch"}
{"id":"productiviy-system-8lq","title":"Create slack-webhook edge function","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-06T08:21:20.100689-05:00","created_by":"benigeri","updated_at":"2026-01-06T09:34:35.3323-05:00","closed_at":"2026-01-06T09:34:35.3323-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-8lq","depends_on_id":"productiviy-system-p9v","type":"blocks","created_at":"2026-01-06T08:21:26.819744-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-8lq","depends_on_id":"productiviy-system-1e8","type":"blocks","created_at":"2026-01-06T08:21:26.897276-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-960","title":"Write tests for claude.ts, then implement","description":"TDD: Write tests for cleanupContent function including edge cases, then implement","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:29.554419-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:23:29.367995-05:00","closed_at":"2026-01-05T13:23:29.367995-05:00","close_reason":"All tests pass for claude.ts"}
{"id":"productiviy-system-96g","title":"Show recipients before generating draft","description":"After user dictates, show likely To/CC recipients before generating full draft. Allows user to adjust if needed. See: .claude/skills/email-respond/IMPROVEMENT-PLAN.md","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T10:19:48.98899-05:00","created_by":"benigeri","updated_at":"2026-01-08T11:00:17.692369-05:00","closed_at":"2026-01-08T11:00:17.692369-05:00","close_reason":"Added recipient confirmation step to SKILL.md workflow before draft generation"}
{"id":"productiviy-system-9lx","title":"Email workflow: Create draft-email.py Anthropic wrapper","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T21:03:25.036645-05:00","created_by":"benigeri","updated_at":"2026-01-07T21:28:18.975412-05:00","closed_at":"2026-01-07T21:28:18.975412-05:00","close_reason":"Merged PR #33. draft-email.py fetches thread via Nylas Clean Messages API and generates draft response with Anthropic.","dependencies":[{"issue_id":"productiviy-system-9lx","depends_on_id":"productiviy-system-oc8","type":"blocks","created_at":"2026-01-07T21:03:38.306229-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-9oa","title":"Simplify session summary to single drafts link","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T15:59:29.820141-05:00","created_by":"benigeri","updated_at":"2026-01-08T17:38:22.810217-05:00","closed_at":"2026-01-08T17:38:22.810217-05:00","close_reason":"Implemented in feature/ux-improvements branch"}
{"id":"productiviy-system-a5j","title":"Fix line breaks in draft preview (Bug #7)","description":"Line breaks missing in tmux preview. Fix: Update sed to preserve \u003cbr\u003e and \u003c/p\u003e as newlines before stripping HTML. See: .claude/skills/email-respond/IMPROVEMENT-PLAN.md","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-08T10:19:37.918809-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:31:19.499975-05:00","closed_at":"2026-01-08T10:31:19.499975-05:00","close_reason":"Fixed HTML to text conversion in panel-manager.sh to preserve line breaks"}
{"id":"productiviy-system-a90","title":"Add secrets to Supabase","description":"Set TELEGRAM_BOT_TOKEN, LINEAR_API_KEY, DEEPGRAM_API_KEY, ANTHROPIC_API_KEY via supabase secrets set","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:38.637818-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:49:39.989514-05:00","closed_at":"2026-01-05T13:49:39.989514-05:00","close_reason":"Closed"}
{"id":"productiviy-system-ac7","title":"Improve MCP server documentation and setup guide","description":"Create comprehensive documentation for the lever-remote MCP server including:\n- Setup instructions for Mac users\n- One-line install command\n- Explanation of machine-level vs account-level config\n- Troubleshooting guide\n- How to verify the MCP server is working\n- Example usage in Claude desktop app\n\nCurrent gap: Users need to manually understand the config file structure and there's no easy way to share the setup with others.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T18:12:19.726325-05:00","created_by":"benigeri","updated_at":"2026-01-10T18:12:27.709495-05:00"}
{"id":"productiviy-system-ac8","title":"Email workflow: Test end-to-end flow","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T21:03:25.76298-05:00","created_by":"benigeri","updated_at":"2026-01-09T23:07:38.052378-05:00","closed_at":"2026-01-09T23:07:38.052378-05:00","close_reason":"E2E testing complete. All bugs fixed: hotkeys work, display clean, formatting good. PR #57 created.","dependencies":[{"issue_id":"productiviy-system-ac8","depends_on_id":"productiviy-system-ngo","type":"blocks","created_at":"2026-01-07T21:03:38.477463-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-ac8","depends_on_id":"productiviy-system-b65","type":"blocks","created_at":"2026-01-08T10:48:03.980255-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-agg","title":"Create weekly-cadence skill directory structure","description":"Set up the skill directory at `~/.claude/skills/weekly-cadence/`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.567399-05:00","updated_at":"2026-01-06T18:40:32.861807-05:00","closed_at":"2026-01-06T18:40:32.861807-05:00","close_reason":"Env vars in .zshrc, directory at ~/.claude/skills/weekly-cadence/","dependencies":[{"issue_id":"productiviy-system-agg","depends_on_id":"productiviy-system-5r9","type":"parent-child","created_at":"2026-01-06T08:42:02.676218-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-alf","title":"nylas-webhook: handler + tests","description":"TDD: Create webhook handler in index.ts:\n- Challenge verification (GET with challenge param)\n- Signature verification (x-nylas-signature header)\n- Route message.updated and message.created events\n- Async processing: return 200 immediately, process in background\n- Idempotent: clearOtherWorkflowLabels(messageId, keepLabel)\n- Triggers: label added, reply sent, message archived (INBOX removed)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T11:27:58.740978-05:00","created_by":"benigeri","updated_at":"2026-01-07T15:19:47.053632-05:00","closed_at":"2026-01-07T15:19:47.053632-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-alf","depends_on_id":"productiviy-system-7d5","type":"blocks","created_at":"2026-01-07T11:28:27.484295-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-alf","depends_on_id":"productiviy-system-l9c","type":"blocks","created_at":"2026-01-07T11:28:27.584799-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-b0o","title":"Email Workflow: Build draft API route","description":"Create app/api/drafts/route.ts for draft generation + save.\n\nIncludes:\n- Zod validation for request\n- Braintrust invoke for LLM draft generation\n- Nylas API call to create Gmail draft\n- Update labels (call /api/threads)\n- Error handling with logging\n\nFile: app/api/drafts/route.ts (~80 lines)\nEstimated: 1 day","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T12:32:04.015684-05:00","created_by":"benigeri","updated_at":"2026-01-10T12:44:15.861937-05:00","closed_at":"2026-01-10T12:44:15.861937-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-b0o","depends_on_id":"productiviy-system-4fi","type":"blocks","created_at":"2026-01-10T12:32:29.220832-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-b65","title":"Add session summary with Gmail draft links","description":"At end of workflow, show summary with clickable Gmail links to review all drafts created. See: .claude/skills/email-respond/IMPROVEMENT-PLAN.md","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T10:19:49.50469-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:50:59.990446-05:00","closed_at":"2026-01-08T10:50:59.990446-05:00","close_reason":"Updated SKILL.md with session summary format and draft tracking"}
{"id":"productiviy-system-bdp","title":"Write tests for telegram.ts, then implement","description":"TDD: Write tests for parseWebhookUpdate, getFileUrl, validateWebhookSignature functions, then implement","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:29.174902-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:21:24.382309-05:00","closed_at":"2026-01-05T13:21:24.382309-05:00","close_reason":"All tests pass for telegram.ts"}
{"id":"productiviy-system-bw2","title":"Email workflow: Update email-canvas.py for thread+draft display","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T21:03:24.714607-05:00","created_by":"benigeri","updated_at":"2026-01-07T21:45:54.982213-05:00","closed_at":"2026-01-07T21:45:54.982213-05:00","close_reason":"Merged PR #34. email-canvas.py provides terminal panel display with list, thread, and draft modes.","dependencies":[{"issue_id":"productiviy-system-bw2","depends_on_id":"productiviy-system-oc8","type":"blocks","created_at":"2026-01-07T21:03:38.255717-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-c1t","title":"Write tests for deepgram.ts, then implement","description":"TDD: Write tests for transcribeAudio function including error handling, then implement","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:29.362493-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:22:45.330651-05:00","closed_at":"2026-01-05T13:22:45.330651-05:00","close_reason":"All tests pass for deepgram.ts"}
{"id":"productiviy-system-ceg","title":"Create email_utils.py shared library","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T19:29:17.000401-05:00","created_by":"benigeri","updated_at":"2026-01-09T20:22:47.178843-05:00","closed_at":"2026-01-09T20:22:47.178843-05:00","close_reason":"Closed"}
{"id":"productiviy-system-ct2","title":"Get API keys: Deepgram + Anthropic","description":"Setup task: Obtain API keys for Deepgram (voice transcription) and Anthropic (Claude for title/desc cleanup)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T11:00:21.441481-05:00","created_by":"benigeri","updated_at":"2026-01-05T12:52:17.416729-05:00","closed_at":"2026-01-05T12:52:17.416729-05:00","close_reason":"Keys stored in .env and verified working"}
{"id":"productiviy-system-cwq","title":"Fix label update failing on threads with SENT folder","description":"update_thread_labels fails with 'unsupported Google label: SENT' when thread has system folders. Need to filter out system labels (SENT, DRAFT, etc) before updating. Draft creation works, only label update fails.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T10:39:08.998325-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:43:51.544382-05:00","closed_at":"2026-01-08T10:43:51.544382-05:00","close_reason":"Added GMAIL_SYSTEM_FOLDERS filter to exclude SENT, DRAFT, etc. from label updates"}
{"id":"productiviy-system-dxe","title":"Email Workflow: Setup Next.js app","description":"Create Next.js 15 app with dependencies (braintrust, zod).\n\nSetup:\n- Create app with TypeScript, Tailwind\n- Install braintrust, zod\n- Add .env.local with API keys\n- Create Braintrust prompt in dashboard\n\nFiles: package.json, .env.local\nEstimated: 4 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T12:31:52.2311-05:00","created_by":"benigeri","updated_at":"2026-01-10T12:39:14.051016-05:00","closed_at":"2026-01-10T12:39:14.051016-05:00","close_reason":"Closed"}
{"id":"productiviy-system-fce","title":"Add request cancellation with AbortController","description":"Implement AbortController to cancel in-flight API requests when user navigates away from thread detail page.\n\n**Context**: PR #61 performance review found that draft generation requests continue even after user navigates away, wasting bandwidth and API quota.\n\n**Problem**:\n- User starts draft generation\n- User navigates to next thread\n- Old request continues in background\n- Wastes Braintrust API calls\n- Response tries to update unmounted component\n\n**Scope**:\n- Add AbortController to generateDraft() function\n- Add AbortController to regenerateDraft() function\n- Cancel requests in useEffect cleanup\n- Handle AbortError gracefully (don't show error to user)\n- Write tests for cancellation behavior\n\n**Affected Functions**:\n- ThreadDetail.tsx:47-91 - generateDraft()\n- ThreadDetail.tsx:93-137 - regenerateDraft()\n\n**Acceptance Criteria**:\n- [ ] AbortController created for each request\n- [ ] Requests cancelled on component unmount\n- [ ] AbortError handled without showing error\n- [ ] Tests verify cancellation works\n- [ ] Network tab shows cancelled requests\n\n**Resources**:\n- Performance review findings\n- AbortController docs: https://developer.mozilla.org/en-US/docs/Web/API/AbortController","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:43.627493-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:43.627493-05:00"}
{"id":"productiviy-system-fpx","title":"Create Telegram bot via @BotFather, get token","description":"Setup task: Create a new Telegram bot using BotFather and save the bot token","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T11:00:17.455514-05:00","created_by":"benigeri","updated_at":"2026-01-05T12:34:36.212592-05:00","closed_at":"2026-01-05T12:34:36.212592-05:00","close_reason":"Token stored in .env"}
{"id":"productiviy-system-fxs","title":"Add dictation artifact note to draft-email prompt","description":"Add note to Claude prompt to ignore transcription artifacts like repeated words, filler words at end of dictation. See: .claude/skills/email-respond/IMPROVEMENT-PLAN.md","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T10:19:50.022876-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:57:07.684581-05:00","closed_at":"2026-01-08T10:57:07.684581-05:00","close_reason":"Added dictation artifact note to prompt in draft-email.py"}
{"id":"productiviy-system-fy3","title":"draft-email.py: --previous-draft fails when piping to same file","description":"Running 'python draft-email.py ... --previous-draft /tmp/file.json \u003e /tmp/file.json' fails because shell truncates the file before script reads it. Need to either: 1) Write to temp file then move, 2) Use different output mechanism, or 3) Document this limitation.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T08:32:11.616503-05:00","created_by":"benigeri","updated_at":"2026-01-09T08:48:58.500531-05:00","closed_at":"2026-01-09T08:48:58.500531-05:00","close_reason":"Fixed in commit 0367a7a on fix/email-workflow-bugs branch"}
{"id":"productiviy-system-g3c","title":"Fix draft not appearing in Gmail (Bug #6)","description":"Added --verify and --no-reply-to debug flags to create-gmail-draft.py. Need live testing to diagnose: try --no-reply-to to see if draft appears, use --verify to confirm creation. Original issue: Script reports success but draft doesn't show in Gmail.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T10:19:37.586396-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:42:43.08656-05:00","closed_at":"2026-01-08T10:42:43.08656-05:00","close_reason":"Verified working - draft creation confirmed with --verify flag during E2E test"}
{"id":"productiviy-system-gvp","title":"Add forward feature to email workflow web app","description":"Add forward feature to web app (https://email-workflow-phi.vercel.app). When viewing a thread, add 'Forward' button that allows user to forward the entire thread to a new recipient. **Nylas API Research (keep for reference):** No native forward endpoint - must manually build forward body. Use Gmail-style format with gmail_quote div (NOT blockquote). Include forwarded message headers (From/Date/Subject/To). Set subject to 'Fwd: {original}'. Omit reply_to_message_id (forwards start new threads). See original bead description for detailed HTML format examples.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-09T12:00:26.60608-05:00","created_by":"benigeri","updated_at":"2026-01-10T13:33:13.715145-05:00"}
{"id":"productiviy-system-hft","title":"Set up Nylas environment variables","description":"Configure shell profile with required Nylas credentials.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.566675-05:00","updated_at":"2026-01-06T18:40:32.858545-05:00","closed_at":"2026-01-06T18:40:32.858545-05:00","close_reason":"Env vars in .zshrc, directory at ~/.claude/skills/weekly-cadence/","dependencies":[{"issue_id":"productiviy-system-hft","depends_on_id":"productiviy-system-5r9","type":"parent-child","created_at":"2026-01-06T08:41:57.286255-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-hkq","title":"Parallelize draft save and label update in approve flow","description":"Optimize the approve workflow by running draft save and label update API calls in parallel instead of sequentially.\n\n**Context**: PR #61 performance review found that approve action takes 700ms due to sequential API calls: draft save (500ms) → wait → label update (200ms).\n\n**Current Flow**:\n```\nDraft save:     [========] 500ms\n                           Label update: [====] 200ms\nTotal:          [============] 700ms\n```\n\n**Optimized Flow**:\n```\nDraft save:     [========] 500ms\nLabel update:   [====] 200ms\nTotal:          [========] 500ms (30% faster)\n```\n\n**Scope**:\n- Refactor PUT /api/drafts route.ts:136-148\n- Use Promise.all() to run both operations concurrently\n- Handle partial failures (draft succeeds, labels fail)\n- Return appropriate status codes\n- Write tests for parallel execution\n\n**Acceptance Criteria**:\n- [ ] Draft save and label update run in parallel\n- [ ] Total time reduced from 700ms to ~500ms\n- [ ] Partial failures handled correctly\n- [ ] Tests verify both operations execute\n- [ ] Performance improvement measured\n\n**Resources**:\n- Performance review findings\n- File: email-workflow/app/api/drafts/route.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T19:22:43.460025-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:43.460025-05:00"}
{"id":"productiviy-system-hl2","title":"Add reply confirmation or bot like for message acknowledgment","description":"When a message is processed successfully, the bot should either reply with a confirmation message containing the Linear issue link, or react/like the original message to acknowledge receipt. This provides user feedback that their message was captured.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-05T13:54:21.558806-05:00","created_by":"benigeri","updated_at":"2026-01-05T14:06:31.47049-05:00","closed_at":"2026-01-05T14:06:31.47049-05:00","close_reason":"Closed"}
{"id":"productiviy-system-i3u","title":"Fix label removal after draft creation (Bug #5)","description":"Labels not being removed after draft creation. Root cause: update_message_labels() updates ONE message, not thread. Fix: Use thread update endpoint or update all messages. See: .claude/skills/email-respond/IMPROVEMENT-PLAN.md","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T10:19:37.245877-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:31:19.201814-05:00","closed_at":"2026-01-08T10:31:19.201814-05:00","close_reason":"Fixed label update to use thread endpoint instead of message endpoint"}
{"id":"productiviy-system-id1","title":"Add authentication to email workflow API routes","description":"Implement authentication middleware to protect all email workflow API endpoints from unauthorized access.\n\n**Context**: PR #61 review found NO authentication on any API routes. Anyone can call /api/drafts, /api/threads without logging in.\n\n**Current Risk**:\n- Unauthorized access to email operations\n- Anyone can generate drafts\n- Anyone can save drafts to Gmail\n- Anyone can modify email labels\n\n**Scope**:\n- Implement Next.js middleware with session validation\n- Add authentication check to all /api/* routes\n- Verify user owns the Nylas grant ID\n- Return 401 Unauthorized for unauthenticated requests\n- Add session management (cookie or JWT)\n- Write tests for auth middleware\n\n**Acceptance Criteria**:\n- [ ] Middleware checks authentication on all API routes\n- [ ] Unauthenticated requests return 401\n- [ ] User session verified before API access\n- [ ] Nylas grant ID ownership validated\n- [ ] Tests verify auth requirements\n\n**Resources**:\n- Security review findings\n- Next.js Auth docs: https://nextjs.org/docs/app/building-your-application/authentication","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:43.303671-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:43.303671-05:00"}
{"id":"productiviy-system-idc","title":"Combine duplicate JSON output in create-gmail-draft.py","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-08T15:59:19.7674-05:00","created_by":"benigeri","updated_at":"2026-01-08T16:44:49.692851-05:00","closed_at":"2026-01-08T16:44:49.692851-05:00","close_reason":"Fixed in PR #44: single JSON output, label verification"}
{"id":"productiviy-system-jdb","title":"Refactor ThreadDetail component into smaller components","description":"Break down the 352-line ThreadDetail component into smaller, focused components following single responsibility principle.\n\n**Context**: PR #61 code review found ThreadDetail.tsx has too many responsibilities, making it hard to test and maintain.\n\n**Current Issues**:\n- 352 lines in single component\n- 7 state variables\n- 4 async functions\n- Mixed concerns: draft gen, iteration, navigation, session tracking, Gmail persistence\n\n**Proposed Structure**:\n```\nThreadDetail (orchestrator, 50 lines)\n├─ ThreadMessages (read-only message display, 40 lines)\n├─ ConversationHistory (iteration history display, 50 lines)\n└─ DraftWorkspace (150 lines)\n   ├─ DraftComposer (generate initial draft, 50 lines)\n   ├─ DraftPreview (show current draft, 30 lines)\n   ├─ DraftIterator (feedback + regenerate, 50 lines)\n   └─ DraftActions (skip + approve buttons, 40 lines)\n```\n\n**Scope**:\n- Extract ThreadMessages component\n- Extract ConversationHistory component\n- Extract DraftWorkspace with sub-components\n- Move business logic to custom hooks\n- Update tests for new components\n- Ensure all functionality preserved\n\n**Acceptance Criteria**:\n- [ ] ThreadDetail.tsx \u003c 100 lines\n- [ ] Each component has single responsibility\n- [ ] All components properly typed\n- [ ] Existing functionality unchanged\n- [ ] Tests updated and passing\n- [ ] No prop drilling (use context if needed)\n\n**Resources**:\n- File: email-workflow/app/inbox/ThreadDetail.tsx\n- React component composition docs","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:44.114188-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:44.114188-05:00"}
{"id":"productiviy-system-knx","title":"Deploy function + set Telegram webhook","description":"Deploy edge function to Supabase and configure Telegram webhook URL","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:38.470082-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:49:55.262641-05:00","closed_at":"2026-01-05T13:49:55.262641-05:00","close_reason":"Closed"}
{"id":"productiviy-system-l9c","title":"nylas-webhook: workflow label logic + tests","description":"TDD: Create workflow label logic in lib/workflow-labels.ts:\n- isWorkflowLabel(folder): check if folder is a workflow label\n- getWorkflowLabels(folders): extract workflow labels from folder list\n- removeWorkflowLabels(folders, keepLabel?): filter out workflow labels\n- getHighestPriorityLabel(labels): return highest priority workflow label\n- All operations must be idempotent","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T11:27:57.162742-05:00","created_by":"benigeri","updated_at":"2026-01-07T14:37:16.768643-05:00","closed_at":"2026-01-07T14:37:16.768643-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-l9c","depends_on_id":"productiviy-system-peq","type":"blocks","created_at":"2026-01-07T11:28:25.468086-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-m5w","title":"Test end-to-end: reply → comment on issue","description":"Milestone 2: E2E test - reply to Telegram message creates comment on corresponding Linear issue","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-05T11:00:52.419636-05:00","created_by":"benigeri","updated_at":"2026-01-05T11:00:52.419636-05:00"}
{"id":"productiviy-system-mhg","title":"Email workflow: Debug draft-email.py prompts for better output","description":"## Problem\nUser dictation is NOT passed to the AI at all!\ndraft-email.py only accepts thread_id, not what the user wants to say.\n\n## Solution  \nAdd --dictation argument to draft-email.py. See docs/email-workflow-improvements.md Issue #2.\n\n## Implementation\n- Add --dictation (required), --feedback, --previous-draft args\n- Update prompt structure: [guidelines] + [examples] + [thread] + [dictation]\n- Support multi-turn for feedback iterations\n\n## This is Phase 1 - do this first!","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-07T22:27:19.640325-05:00","created_by":"benigeri","updated_at":"2026-01-08T08:23:02.025186-05:00","closed_at":"2026-01-08T08:23:02.025186-05:00","close_reason":"Phase 1 complete: Added --dictation, --feedback, --previous-draft args to draft-email.py. PR #39 created."}
{"id":"productiviy-system-n0i","title":"Email Workflow: Add Skip and Approve buttons with navigation","description":"Add Skip/Approve buttons and auto-advance logic.\n\n**Skip Button:**\n- Go to next email in list\n- Leave labels unchanged\n- Clear conversation state\n- No draft saved\n\n**Approve Button:**\n- Create new PUT /api/drafts route\n- Save draft to Gmail via Nylas\n- Update labels (remove to-respond-paul, add drafted)\n- Clear conversation state\n- Auto-advance to next email\n\n**Navigation:**\n- Get next thread ID from inbox\n- Redirect to /inbox?thread={nextId}\n- If last email, redirect to /inbox\n\n**Test:**\n- Skip advances without saving\n- Approve saves and advances\n- Labels update correctly\n- Last email returns to inbox","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-10T16:35:56.286019-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:03:24.058434-05:00"}
{"id":"productiviy-system-ngo","title":"Email workflow: Rewrite SKILL.md with threads+panel+AI","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T21:03:25.393108-05:00","created_by":"benigeri","updated_at":"2026-01-07T22:06:28.15393-05:00","closed_at":"2026-01-07T22:06:28.15393-05:00","close_reason":"Merged PR #35: SKILL.md rewritten for thread-based workflow with tmux panel, AI drafting, and simplified JSON output","dependencies":[{"issue_id":"productiviy-system-ngo","depends_on_id":"productiviy-system-bw2","type":"blocks","created_at":"2026-01-07T21:03:38.362675-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-ngo","depends_on_id":"productiviy-system-9lx","type":"blocks","created_at":"2026-01-07T21:03:38.424494-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-oc8","title":"Email workflow: Create drafted label","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T21:03:24.361258-05:00","created_by":"benigeri","updated_at":"2026-01-07T21:11:26.565819-05:00","closed_at":"2026-01-07T21:11:26.565819-05:00","close_reason":"Created 'drafted' label (Label_215) in Gmail via Nylas API. All workflow labels now exist: to-respond-paul, to-read-paul, drafted."}
{"id":"productiviy-system-ohj","title":"Email Workflow: Implement draft feedback/iteration loop","description":"Add feedback textbox and regeneration flow.\n\n**UI:**\n- Feedback textarea below draft preview\n- 'Regenerate' button (or auto-trigger on submit)\n- Loading state during regeneration\n- Replace draft with new version\n\n**Flow:**\n1. User types feedback in textarea\n2. Click regenerate (or press Enter)\n3. Append feedback to conversation state\n4. Call POST /api/drafts with full conversation\n5. Show loading state\n6. Replace draft with new version\n7. Clear feedback textarea\n\n**Braintrust Integration:**\n- Pass full conversation history\n- Use messages array for context\n- Return only new assistant message\n\n**Test:**\n- Can iterate multiple times\n- Conversation history maintained\n- Draft updates correctly\n- Loading states work","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-10T16:35:56.515408-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:03:24.13452-05:00"}
{"id":"productiviy-system-ouq","title":"Debug: Labels not updating after draft creation","description":"Labels (to-respond-paul → drafted) not being updated after draft creation despite previous fix. Need to debug create-gmail-draft.py label update logic. Previous fix (productiviy-system-i3u) claimed to use thread endpoint but may not be working.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T11:16:38.909086-05:00","created_by":"benigeri","updated_at":"2026-01-08T16:51:42.036367-05:00","closed_at":"2026-01-08T16:51:42.036367-05:00","close_reason":"Fixed in PR #44 and #45: label verification + INBOX filter"}
{"id":"productiviy-system-p9o","title":"Fix DRAFT system folder error in create-gmail-draft.py","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T15:59:18.814423-05:00","created_by":"benigeri","updated_at":"2026-01-08T16:51:42.022361-05:00","closed_at":"2026-01-08T16:51:42.022361-05:00","close_reason":"Fixed in PR #44 and #45: label verification + INBOX filter"}
{"id":"productiviy-system-p9v","title":"Refactor telegram-webhook to use captureToLinear()","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T08:21:16.6356-05:00","created_by":"benigeri","updated_at":"2026-01-06T09:18:38.501183-05:00","closed_at":"2026-01-06T09:18:38.501183-05:00","close_reason":"Closed","dependencies":[{"issue_id":"productiviy-system-p9v","depends_on_id":"productiviy-system-0sq","type":"blocks","created_at":"2026-01-06T08:21:26.669001-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-pb3","title":"Write integration tests for index.ts, then implement","description":"TDD: Write integration tests for main handler - text and voice message flows, error handling","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:38.259414-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:26:19.371928-05:00","closed_at":"2026-01-05T13:26:19.371928-05:00","close_reason":"All 38 tests pass"}
{"id":"productiviy-system-peq","title":"nylas-webhook: shared types (nylas-types.ts)","description":"Create shared Nylas types in _shared/lib/nylas-types.ts:\n- NylasMessage, NylasThread, NylasWebhookPayload interfaces\n- WORKFLOW_LABELS constant: to-respond-paul, to-read-paul, drafted\n- Label priority order: to-respond \u003e to-read \u003e drafted\n- Helper type: WorkflowLabel","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T11:27:54.466039-05:00","created_by":"benigeri","updated_at":"2026-01-07T14:27:19.980447-05:00","closed_at":"2026-01-07T14:27:19.980447-05:00","close_reason":"Closed"}
{"id":"productiviy-system-rbm","title":"Email Workflow: Install shadcn UI components","description":"Install shadcn/ui with vanilla setup.\n\n**Components to add:**\n- Button\n- Card (CardHeader, CardContent)\n- Textarea\n- Input\n- Badge (for message labels)\n\n**Steps:**\n1. Run shadcn/ui init\n2. Add components via CLI\n3. Verify styling works with Tailwind\n4. Update globals.css if needed\n\n**Test:**\n- Components render correctly\n- Styling matches shadcn defaults\n- No build errors","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T16:35:55.669135-05:00","created_by":"benigeri","updated_at":"2026-01-10T18:22:30.283698-05:00","closed_at":"2026-01-10T18:22:30.283698-05:00","close_reason":"Closed"}
{"id":"productiviy-system-rdv","title":"Fix line spacing in email draft preview","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-09T19:29:16.814532-05:00","created_by":"benigeri","updated_at":"2026-01-09T19:47:40.88541-05:00","closed_at":"2026-01-09T19:47:40.88541-05:00","close_reason":"Fixed in PR #53"}
{"id":"productiviy-system-rxr","title":"Fix label update return value ignored in create-gmail-draft.py","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T15:59:19.266184-05:00","created_by":"benigeri","updated_at":"2026-01-08T16:44:49.709061-05:00","closed_at":"2026-01-08T16:44:49.709061-05:00","close_reason":"Fixed in PR #44: single JSON output, label verification"}
{"id":"productiviy-system-smy","title":"Email workflow: Improve tmux panel rendering performance","description":"## Problem\nPanel is slow: process restart per update, 3+ API calls each time, no caching.\nPanel sometimes disappears due to tmux send-keys escaping issues.\n\n## Solution\nPersistent process + Named Pipe (FIFO) IPC + caching. See docs/email-workflow-improvements.md Issue #3.\n\n## Implementation\n- Add --server mode to email-canvas.py\n- FIFO at /tmp/email-panel.fifo for commands\n- Base64 encode body content for multiline safety\n- In-memory cache for API responses\n- Loading indicators during API calls\n\n## This is Phase 3 - largest change, do last","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T22:27:19.890133-05:00","created_by":"benigeri","updated_at":"2026-01-08T16:51:47.991175-05:00","closed_at":"2026-01-08T16:51:47.991175-05:00","close_reason":"Implemented: server mode with stdin IPC, caching, loading indicators","dependencies":[{"issue_id":"productiviy-system-smy","depends_on_id":"productiviy-system-126","type":"blocks","created_at":"2026-01-08T08:15:46.818096-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-stv","title":"Email Workflow: Documentation","description":"Document the deployed app and usage.\n\nTasks:\n- Add README.md with setup instructions\n- Document environment variables\n- Add robots.txt for no indexing\n- Document mobile UX patterns\n- Add troubleshooting guide\n\nEstimated: 2 hours","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T12:32:24.453415-05:00","created_by":"benigeri","updated_at":"2026-01-10T13:18:58.013674-05:00","closed_at":"2026-01-10T13:18:58.013674-05:00","close_reason":"Essential documentation complete: README.md with setup instructions, DEPLOYMENT.md with deployment guide, STATUS.md with project status, robots.txt for SEO prevention, and troubleshooting guide included. Mobile UX patterns deferred as lower priority.","dependencies":[{"issue_id":"productiviy-system-stv","depends_on_id":"productiviy-system-urq","type":"blocks","created_at":"2026-01-10T12:32:29.349232-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-sy7","title":"Text to add to todo list","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T21:36:26.758638-05:00","created_by":"benigeri","updated_at":"2026-01-05T11:01:15.2126-05:00","closed_at":"2026-01-05T11:01:15.2126-05:00","close_reason":"Replaced with Telegram pipeline beads"}
{"id":"productiviy-system-ucw","title":"Add progress count display to email panel","description":"Show running count like '3/12 drafted, 2 skipped' in panel header during workflow. See: .claude/skills/email-respond/IMPROVEMENT-PLAN.md","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T10:19:48.297908-05:00","created_by":"benigeri","updated_at":"2026-01-08T10:59:31.615519-05:00","closed_at":"2026-01-08T10:59:31.615519-05:00","close_reason":"Added --drafted and --skipped args to email-canvas.py and panel-manager.sh"}
{"id":"productiviy-system-umh","title":"Handle localStorage quota exceeded in email workflow","description":"## Problem\nSilent data loss when localStorage quota is exceeded (5-10MB limit). Users lose conversation history without notification.\n\n## Solution\nImplement automatic pruning (keep last 20 conversations, 7-day TTL) with user notifications when quota is reached.\n\n## Acceptance Criteria\n- QuotaExceededError detected and handled\n- Automatic pruning removes old conversations\n- User sees notification when storage limit reached\n- Function returns boolean success/failure status\n\n## Resources\n- Todo file: todos/002-pending-p1-handle-localstorage-quota-exceeded.md\n- PR #60: https://github.com/benigeri/productiviy-system/pull/60\n- File: email-workflow/lib/conversation.ts\n\n## Effort\n2-3 hours","status":"open","priority":0,"issue_type":"bug","created_at":"2026-01-10T18:51:44.914155-05:00","created_by":"benigeri","updated_at":"2026-01-10T18:51:44.914155-05:00"}
{"id":"productiviy-system-urq","title":"Email Workflow: Test \u0026 Deploy","description":"Test locally and deploy to Vercel.\n\nTasks:\n- Test with real emails locally\n- Verify mobile responsive\n- Test error scenarios\n- Push to GitHub\n- Deploy to Vercel\n- Add environment variables\n- Test deployed version on mobile\n\nEstimated: 4 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-10T12:32:19.607465-05:00","created_by":"benigeri","updated_at":"2026-01-10T13:12:28.587293-05:00","closed_at":"2026-01-10T13:12:28.587293-05:00","close_reason":"Deployment complete and verified. App successfully deployed to https://email-workflow-phi.vercel.app with full end-to-end workflow tested (inbox loading, thread viewing, draft generation via Braintrust, draft saving to Gmail via Nylas, label updates). Fixed 3 issues during deployment: Zod validation, Braintrust Mustache template syntax, and environment variable formatting.","dependencies":[{"issue_id":"productiviy-system-urq","depends_on_id":"productiviy-system-3jh","type":"blocks","created_at":"2026-01-10T12:32:29.302388-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-uvi","title":"Create iOS Shortcut to open bot chat","description":"Create iOS Shortcut using tg://resolve?domain=BOT_USERNAME URL for one-tap access","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-05T11:00:39.073625-05:00","created_by":"benigeri","updated_at":"2026-01-05T14:23:45.549174-05:00","closed_at":"2026-01-05T14:23:45.549174-05:00","close_reason":"User set up shortcut manually"}
{"id":"productiviy-system-v31","title":"Write SKILL.md with workflow instructions","description":"Create main skill file with Claude instructions for the calendar management workflow.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.567796-05:00","updated_at":"2026-01-06T18:43:04.935892-05:00","closed_at":"2026-01-06T18:43:04.935892-05:00","close_reason":"Created SKILL.md with trigger, workflow, defaults, and example interaction","dependencies":[{"issue_id":"productiviy-system-v31","depends_on_id":"productiviy-system-5r9","type":"parent-child","created_at":"2026-01-06T08:42:02.810896-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-v31","depends_on_id":"productiviy-system-agg","type":"blocks","created_at":"2026-01-06T08:42:08.435391-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-vbf","title":"Test end-to-end: text + voice → Linear triage","description":"End-to-end testing: send text and voice messages via Telegram, verify Linear triage items are created","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:00:38.857909-05:00","created_by":"benigeri","updated_at":"2026-01-05T13:55:11.254951-05:00","closed_at":"2026-01-05T13:55:11.254951-05:00","close_reason":"Closed"}
{"id":"productiviy-system-vui","title":"Create nylas-api-reference.md","description":"Document Nylas API endpoints for reference.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.568036-05:00","updated_at":"2026-01-06T18:42:31.913105-05:00","closed_at":"2026-01-06T18:42:31.913105-05:00","close_reason":"Created nylas-api-reference.md with endpoints, examples, and time format docs","dependencies":[{"issue_id":"productiviy-system-vui","depends_on_id":"productiviy-system-5r9","type":"parent-child","created_at":"2026-01-06T08:42:02.889597-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-vvs","title":"Investigate: /manage-calendar not visible in slash menu","description":"User reports /manage-calendar command exists but doesn't appear in slash command menu. Command file exists at .claude/commands/manage-calendar.md. Need to investigate why it's not showing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T08:32:12.16545-05:00","created_by":"benigeri","updated_at":"2026-01-09T08:48:58.493065-05:00","closed_at":"2026-01-09T08:48:58.493065-05:00","close_reason":"Fixed in commit 0367a7a on fix/email-workflow-bugs branch"}
{"id":"productiviy-system-vy9","title":"Create new Supabase project","description":"Setup task: Create a Supabase project for hosting the edge function","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-05T11:00:21.186406-05:00","created_by":"benigeri","updated_at":"2026-01-05T12:42:17.197821-05:00","closed_at":"2026-01-05T12:42:17.197821-05:00","close_reason":"Project created, credentials stored in .env"}
{"id":"productiviy-system-wlp","title":"Update email-canvas.py to 100 char width with card-based UI","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T15:59:29.397356-05:00","created_by":"benigeri","updated_at":"2026-01-08T17:38:22.805463-05:00","closed_at":"2026-01-08T17:38:22.805463-05:00","close_reason":"Implemented in feature/ux-improvements branch"}
{"id":"productiviy-system-wx8","title":"Nylas email workflow automation","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-07T11:27:38.049163-05:00","created_by":"benigeri","updated_at":"2026-01-07T16:09:28.004909-05:00","closed_at":"2026-01-07T16:09:28.004909-05:00","close_reason":"Core email workflow automation complete: webhook deployed, deduplication, archive \u0026 send detection all working."}
{"id":"productiviy-system-wy4","title":"Add CSRF protection to email workflow API routes","description":"Add CSRF token validation to all POST/PUT/DELETE endpoints in email-workflow to prevent cross-site request forgery attacks.\n\n**Context**: PR #61 code review identified that API routes have no CSRF protection, allowing attackers to force authenticated users to make unwanted API calls.\n\n**Scope**:\n- Install @edge-csrf/nextjs package\n- Create middleware.ts with CSRF validation for state-changing methods\n- Add CSRF token to page layout (meta tag or cookie)\n- Update all fetch calls in ThreadDetail.tsx to include CSRF token header\n- Add error handling for CSRF validation failures\n- Write tests for CSRF protection\n\n**Acceptance Criteria**:\n- [ ] CSRF middleware active on /api/* routes\n- [ ] POST/PUT/DELETE requests fail without valid token\n- [ ] GET requests work without CSRF token\n- [ ] Client-side fetch calls include CSRF token\n- [ ] Clear error messages when CSRF validation fails\n\n**Resources**:\n- Todo file: todos/009-pending-p0-add-csrf-protection-api-routes.md\n- OWASP CSRF Guide: https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T19:22:42.98731-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:22:42.98731-05:00"}
{"id":"productiviy-system-xdn","title":"nylas-webhook: remove labels on archive/send","description":"Extend webhook to handle:\n1. Archive: When INBOX removed from message, remove workflow labels\n2. Send: When reply sent (message.created in SENT), remove workflow labels from thread\n\nThis completes the core email workflow automation before building the skill.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T16:02:58.764234-05:00","created_by":"benigeri","updated_at":"2026-01-07T16:09:09.017633-05:00","closed_at":"2026-01-07T16:09:09.017633-05:00","close_reason":"Implemented and tested archive/send detection. PR #31."}
{"id":"productiviy-system-xhs","title":"Email Workflow: Refactor draft generation to not auto-save","description":"Update draft generation to show in UI only, no Gmail save until Approve.\n\n**API Changes:**\n- Keep POST /api/drafts for generation only (no Nylas save)\n- Remove auto-save to Gmail\n- Remove label updates from POST route\n- Return draft HTML only\n\n**UI Changes:**\n- Show generated draft in Card component\n- Add to conversation state\n- Don't redirect after generation\n- Show draft with feedback textbox below\n\n**Test:**\n- Draft generates but doesn't appear in Gmail\n- Can view draft in UI\n- Labels unchanged until Approve","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-10T16:35:56.055875-05:00","created_by":"benigeri","updated_at":"2026-01-10T19:03:24.006789-05:00"}
{"id":"productiviy-system-y0o","title":"Email workflow v2 improvements","description":"Email workflow improvements based on E2E testing session (2026-01-08). See plan: .claude/skills/email-respond/IMPROVEMENT-PLAN.md. Bug tracker: .claude/skills/email-respond/E2E-BUGS.md","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-08T10:19:29.133339-05:00","created_by":"benigeri","updated_at":"2026-01-10T13:32:51.017286-05:00","closed_at":"2026-01-10T13:32:51.017286-05:00","close_reason":"TMUX improvements completed Jan 8 (all 8 dependencies closed). Project pivoted to web app on Jan 10 - web app now deployed at https://email-workflow-phi.vercel.app","dependencies":[{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-i3u","type":"blocks","created_at":"2026-01-08T10:21:03.531621-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-g3c","type":"blocks","created_at":"2026-01-08T10:21:03.590991-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-a5j","type":"blocks","created_at":"2026-01-08T10:21:03.666288-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-ucw","type":"blocks","created_at":"2026-01-08T10:21:03.739354-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-96g","type":"blocks","created_at":"2026-01-08T10:21:03.869081-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-b65","type":"blocks","created_at":"2026-01-08T10:21:03.985628-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-fxs","type":"blocks","created_at":"2026-01-08T10:21:04.094855-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-y0o","depends_on_id":"productiviy-system-2fb","type":"blocks","created_at":"2026-01-08T10:23:07.744151-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-zgh","title":"Test Nylas API connectivity","description":"Verify API credentials work and can fetch calendar events.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T08:41:46.568267-05:00","updated_at":"2026-01-06T18:41:07.504146-05:00","closed_at":"2026-01-06T18:41:07.504146-05:00","close_reason":"API connectivity verified - calendar paul@archive.com accessible","dependencies":[{"issue_id":"productiviy-system-zgh","depends_on_id":"productiviy-system-5r9","type":"parent-child","created_at":"2026-01-06T08:42:02.980017-05:00","created_by":"benigeri"},{"issue_id":"productiviy-system-zgh","depends_on_id":"productiviy-system-hft","type":"blocks","created_at":"2026-01-06T08:42:08.385454-05:00","created_by":"benigeri"}]}
{"id":"productiviy-system-zi2","title":"Fix tmux pane width (use -l 102 instead of -p 40)","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-09T19:29:16.52573-05:00","created_by":"benigeri","updated_at":"2026-01-09T19:47:40.883556-05:00","closed_at":"2026-01-09T19:47:40.883556-05:00","close_reason":"Fixed in PR #53"}
